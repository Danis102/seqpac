% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/merge_lanes.R
\name{merge_lanes}
\alias{merge_lanes}
\title{Merge fastq lane files}
\usage{
merge_lanes(in_path, out_path, threads = 1)
}
\arguments{
\item{in_path}{Character string with the path to lane files that should be
merged. The names of the lane files should follow the convention:
'sample1_lane1.fastq.gz, sample1_lane2.fastq.gz, sample2_lane1.fastq.gz,
etc', where the first part of the name indicate the sample while the second
part indicate lanes. The function will automatically identify samples by
file names with idenitcal first parts. The function only takes fastq.gz
compressed files.}

\item{out_path}{Character string with the path to destination folder for
merged fastq.gz files.}

\item{threads}{Integer indicating the number of parallel processes that
should be used.}
}
\value{
Merged fastq files in destination folder.
}
\description{
\code{merge_lanes} Identifies, reads and merges fastq lane files.
}
\details{
Given an input path were flow cell lane files in fastq format (typically
generated by for example Illumina sequencers) this function will try to
identify unique samples among the lane files and merge all lane files for
each sample. The function uses md5 checks to control that each lane file is
unique (no accidental copies) and will compare expected outcomes given that
all samples should have the same number of lanes (comming from the same
experiment).
}
\examples{

## The simple principle: 
# in_path <- "/some/path/to/lane/files/fastq.gz"
# out_path <- "/some/path/to/merged/files/"
# merge_lanes(in_path, out_path, threads=12)


## Real example
# First generate some smallRNA fastq.
# Only one untrimmed fastq comes with seqpac
# Thus, we need to randomly sample that one using the ShortRead-package
 
sys_path = system.file("extdata", package = "seqpac", mustWork = TRUE)
fq <- list.files(path = sys_path, pattern = "fastq", all.files = FALSE,
                full.names = TRUE)

closeAllConnections()

sampler <- ShortRead::FastqSampler(fq, 20000)
set.seed(123)
fqs <- list(fq1_lane1=ShortRead::yield(sampler),
           fq1_lane2=ShortRead::yield(sampler),
           fq1_lane3=ShortRead::yield(sampler),
           fq2_lane1=ShortRead::yield(sampler),
           fq2_lane2=ShortRead::yield(sampler),
           fq2_lane3=ShortRead::yield(sampler))

# Now generate a temp folder were we can store the fastq files
# (for autonomous example, make sure it is empty and correct platform)

input <- paste0(tempdir(), "/seqpac_temp")
fls  <- list.files(input, recursive=TRUE)
if(length(fls)>0){unlink(input, recursive=TRUE)}
dir.create(input, showWarnings=FALSE)

# And then write the random fastq to the temp folder
for (i in 1:length(fqs)){
 input_file <- paste0(input, "/", names(fqs)[i], ".fastq.gz")
 ShortRead::writeFastq(fqs[[i]], input_file, mode="w", 
                       full=FALSE, compress=TRUE)
}

# Create an output folder
output <- paste0(input, "/merged")
dir.create(output, showWarnings=FALSE)

# Then merge the fastq files
merge_lanes(input, output, threads=2)

# You will find the files in:
input
output


##-----------------------------------------##
## Warning: Clean up temp folder           ##
# (Sometimes needed for automated examples) 

closeAllConnections()
fls_temp  <- tempdir()
fls_temp  <- list.files(fls_temp, recursive=TRUE, full.names = TRUE)
suppressWarnings(file.remove(fls_temp))

}
\seealso{
\url{https://github.com/Danis102} for updates on the current
  package.

Other PAC generation: 
\code{\link{PAC_check}()},
\code{\link{getTrim}()},
\code{\link{make_PAC}()},
\code{\link{make_counts}()},
\code{\link{make_cutadapt}()},
\code{\link{make_pheno}()}
}
\concept{PAC generation}
