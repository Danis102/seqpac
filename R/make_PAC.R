#' Make PAC
#'
#' \code{make_PAC} Compiles, order and checks the assumptions of a PAC file.
#'
#' Given a pheno, an anno and a counts data frames the functions will safely
#' generate simple PAC list-object.
#'
#' @family PAC generation
#'
#' @seealso \url{https://github.com/junchaoshi/sports1.0} for download and
#'   documentation about running Sports. \url{https://github.com/Danis102} for
#'   updates on the current package.
#'
#' @param pheno_input Data frame with sample names as row names containing
#'   metadata about each sample. Can be generated by the \code{make_pheno}
#'   function.
#'
#' @param anno_input Data frame with unique sequences as row names containing
#'   metadata about each sequence. Can be generated by the \code{make_anno}
#'   function and annotaions for each sequence can be extended using for
#'   example the reanno workflow.
#'
#' @param counts_input Data frame with column names as sample names and sequence
#'   names as row names. Contains the counts for each sequence across the
#'   samples. Can be generated by the \code{make_counts} \code{make_counts2}
#'   function.
#'   
#'
#' @return Ordered and assumption checked PAC list object, that can be used in
#'   downstream analysis.
#'   
#' @examples
#'
#' ### Load counts
#' load(file="/data/Data_analysis/Projects/Drosophila/Other/IOR/Joint_analysis/R_analysis/temp.Rdata")
#'
#' ## Make Anno
#' anno <- make_anno(input=counts, type="counts")
#'
#'
#' ## Make pheno
#' pheno_input <- read.delim("/data/Data_analysis/Projects/Drosophila/Other/IOR/Joint_analysis/R_analysis/Groups_data.txt", sep=",", header=TRUE)
#' pheno_input$Sample_ID <- gsub("_s", "_notag",  as.character(pheno_input$Sample_ID))
#' pheno_input$Sample_ID <- gsub("_d", "_tag",  as.character(pheno_input$Sample_ID))
#'
#' pheno <- make_pheno(pheno_input=pheno_input, type="manual", countTable=counts[[1]])
#'
#' pheno_input=pheno
#' anno_input=anno
#' counts_input=counts[[1]]
#'
#'
#'
#' @export

make_PAC<- function(pheno_input, anno_input, counts_input){
                                PAC_unord <- list(Pheno=pheno_input, Anno=anno_input, Counts=counts_input)
                                stopifnot(!any(!unlist(lapply(PAC_unord, is.data.frame))))
                                stopifnot(nrow(anno_input) == nrow(counts_input))
                                stopifnot(nrow(pheno_input) == ncol(counts_input))
                                ph_ord <- colnames(PAC_unord$Counts)
                                seq_ord <- rownames(PAC_unord$Counts)
                                PAC_unord$Anno <- PAC_unord$Anno[match(rownames(PAC_unord$Anno), seq_ord),, drop=FALSE]
                                PAC_unord$Pheno <- PAC_unord$Pheno[match(rownames(PAC_unord$Pheno), ph_ord),, drop=FALSE]
                                class(PAC_unord) <-  c("list", "PAC")
                                stopifnot(PAC_check(PAC_unord))
                                return(PAC_unord)
                                }
                                
                                
      
  
  
  
  
  